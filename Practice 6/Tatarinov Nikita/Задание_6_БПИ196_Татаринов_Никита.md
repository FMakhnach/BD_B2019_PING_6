## Задание 6 
 
* Для Олимпийских игр 2004 года сгенерируйте список (год рождения, количество игроков, количество золотых медалей), содержащий годы, в которые родились игроки, количество игроков, родившихся в каждый из этих лет, которые выиграли по крайней мере одну золотую медаль, и количество золотых медалей, завоеванных игроками, родившимися в этом году. 
 
Для начала выделяем события, которые произошли на Олимпийских играх 2004-го года. 
 
```sql 
SELECT event_id FROM events WHERE olympic_id = 'ATH2004'; 
``` 
![image](https://user-images.githubusercontent.com/59981377/139534696-b042d1ba-5dbf-4d2b-8aff-1f72975ec723.png) 
 
Объединяем эту получившуюся таблицу с таблицей результатов results, оставляя только те строки, в которых равны идентификаторы событий event_id и медаль участника является золотой. Далее, группируем строки по идентификатору игрока player_id и считая медали. Таким образом, золотых медалистов, первой столбец которой -- идентификаторы этих золотых медалистов, а второй -- количетсва их золотых медалей на олимпиаде 2004. 
  
```sql 
SELECT player_id, COUNT(medal) as num_of_gold_medals 
FROM results, (SELECT event_id FROM events WHERE olympic_id = 'ATH2004') as events2004 
WHERE results.event_id = events2004.event_id AND results.medal = 'GOLD' GROUP BY player_id; 
``` 
![image](https://user-images.githubusercontent.com/59981377/139534662-6b49d022-3d9c-49fb-80d0-e7fd852204cf.png) 
 
Объединяем таблицу золотых медалистов 2004-го года с таблицей игроков players, оставляя только те строки, в которых идентификаторы игроков player_id равны. Далее, группируем строки по году рождения игроков и оставляем в таблице следующие столбцы: год рождения игроков; количество игроков, родившихся в соответствующий год; суммарное количество медалей этих игроков. Получаем искомая таблицу. 
 
```sql 
SELECT EXTRACT(YEAR FROM players.birthdate) as birthdate_year, COUNT(gold_medalists.player_id) num_of_gold_medalists, 
       SUM(gold_medalists.num_of_gold_medals) as num_of_gold_medals 
FROM players, 
     (SELECT player_id, COUNT(medal) as num_of_gold_medals 
     FROM results, (SELECT event_id FROM events WHERE olympic_id = 'ATH2004') as events2004 
     WHERE results.event_id = events2004.event_id AND results.medal = 'GOLD' GROUP BY player_id) 
         as gold_medalists 
WHERE gold_medalists.player_id = players.player_id 
GROUP BY birthdate_year ORDER BY birthdate_year; 
``` 
![image](https://user-images.githubusercontent.com/59981377/139535007-a14048e6-499a-4c9c-8d99-686091029561.png) 
